       IDENTIFICATION DIVISION.                                         00010000
       PROGRAM-ID.    CA11J026.                                         00020000
                                                                        00030000
       ENVIRONMENT DIVISION.                                            00040000
       CONFIGURATION SECTION.                                           00050000
       INPUT-OUTPUT SECTION.                                            00060000
       FILE-CONTROL.                                                    00070000
                                                                        00080000
           SELECT TI01-INPUT-FILE      ASSIGN TO FILE1                  00090002
           ORGANIZATION                IS SEQUENTIAL                    00100000
           ACCESS MODE                 IS SEQUENTIAL                    00110000
           FILE STATUS                 IS WS-FS1.                       00120000
                                                                        00130000
           SELECT MO01-KSDS-FILE       ASSIGN TO FILE2                  00140002
           ORGANIZATION                IS INDEXED                       00150000
           ACCESS MODE                 IS SEQUENTIAL                    00160000
           RECORD KEY                  IS SHARE-NO-KSDS                 00161000
           FILE STATUS                 IS WS-FS2.                       00170000
                                                                        00180000
       DATA DIVISION.                                                   00190000
                                                                        00200000
       FILE SECTION.                                                    00210000
       FD TI01-INPUT-FILE                                               00220000
           RECORD CONTAINS             80 CHARACTERS                    00230000
           RECORDING MODE              IS F.                            00240000
       01 INPUT-RECORD.                                                 00250000
                                                                        00260000
          05 SHARE-NO                  PIC X(05).                       00270000
          05 FILLER                    PIC X VALUE SPACES.              00280000
          05 PER-HELD                  PIC 9(02).                       00290000
          05 FILLER                    PIC X VALUE SPACES.              00300000
          05 NO-OF-SHARES              PIC 9(03).                       00310000
          05 FILLER                    PIC X VALUE SPACES.              00320000
          05 CORP-NAME                 PIC X(05).                       00330000
          05 FILLER                    PIC X VALUE SPACES.              00340000
          05 CURR-PRICE                PIC 9(03).9(02).                 00350000
          05 FILLER                    PIC X(55) VALUE SPACES.          00360000
                                                                        00361000
       FD MO01-KSDS-FILE.                                               00370000
                                                                        00380000
       01 KSDS-RECORD.                                                  00390000
          05 SHARE-NO-KSDS             PIC X(05).                       00391000
          05 FILLER                    PIC X VALUE SPACES.              00392000
          05 PER-HELD-KSDS             PIC 9(02).                       00393000
          05 FILLER                    PIC X VALUE SPACES.              00394000
          05 NO-OF-SHARES-KSDS         PIC 9(03).                       00395000
          05 FILLER                    PIC X VALUE SPACES.              00396000
          05 CORP-NAME-KSDS            PIC X(05).                       00397000
          05 FILLER                    PIC X VALUE SPACES.              00398000
          05 CURR-PRICE-KSDS           PIC 9(03).9(02).                 00399000
          05 FILLER                    PIC X(55) VALUE SPACES.          00399100
                                                                        00400000
       WORKING-STORAGE SECTION.                                         00410000
                                                                        00420000
       01 WS-STATUS-VARIABLES.                                          00430000
                                                                        00440000
          05 WS-FS1                    PIC X(02).                       00450000
             88 INPUT-IO-STATUS        VALUE '00'.                      00460000
             88 INPUT-EOF              VALUE '10'.                      00470000
          05 WS-FS2                    PIC X(02).                       00480000
             88 KSDS-IO-STATUS         VALUE '00'.                      00490000
                                                                        00500000
       PROCEDURE DIVISION.                                              00510000
       0000-MAIN-PARA.                                                  00520000
                                                                        00530000
           PERFORM 1000-INIT-PARA THRU                                  00540000
                   1000-INIT-PARA-EXIT.                                 00550000
           PERFORM 2000-PROCESS-PARA THRU                               00560000
                   2000-PROCESS-PARA-EXIT.                              00570000
           PERFORM 3000-TERMINATE-PARA THRU                             00580000
                   3000-TERMINATE-PARA-EXIT.                            00590000
       0000-MAIN-PARA. EXIT.                                            00600000
       1000-INIT-PARA.                                                  00610000
                                                                        00620000
           DISPLAY '| THIS IN INTIALIZATION |'.                         00630000
                                                                        00631000
       1000-INIT-PARA-EXIT. EXIT.                                       00640000
       2000-PROCESS-PARA.                                               00650000
           PERFORM 2100-OPEN-PARA THRU                                  00660000
                   2100-OPEN-PARA-EXIT.                                 00670000
           PERFORM 2200-READ-PARA THRU                                  00680000
                   2200-READ-PARA-EXIT                                  00690000
                   UNTIL INPUT-EOF.                                     00700000
       2000-PROCESS-PARA-EXIT. EXIT.                                    00710000
       2100-OPEN-PARA.                                                  00720000
                                                                        00730000
           OPEN INPUT TI01-INPUT-FILE                                   00740000
           EVALUATE TRUE                                                00750000
               WHEN INPUT-IO-STATUS                                     00760000
                    DISPLAY '|INPUT FILE IS OPENED |'                   00770000
               WHEN OTHER                                               00780000
                    DISPLAY '|ERROR IN OPEN INPUT FILE |', WS-FS1       00790000
                    STOP RUN                                            00800000
           END-EVALUATE.                                                00810000
           OPEN OUTPUT MO01-KSDS-FILE                                   00820003
           EVALUATE TRUE                                                00830000
               WHEN KSDS-IO-STATUS                                      00840000
                    DISPLAY '|KSDS  FILE IS OPENED |'                   00850000
                    MOVE SPACES                    TO KSDS-RECORD       00851004
                    WRITE  KSDS-RECORD                                  00852006
               WHEN OTHER                                               00860000
                    DISPLAY '|ERROR IN OPEN KSDS  FILE |', WS-FS2       00870000
                    STOP RUN                                            00880000
           END-EVALUATE.                                                00890000
       2100-OPEN-PARA-EXIT. EXIT.                                       00900000
       2200-READ-PARA.                                                  00910000
           READ TI01-INPUT-FILE                                         00911000
           EVALUATE TRUE                                                00912000
               WHEN INPUT-IO-STATUS                                     00912100
                    PERFORM 2300-WRITE-PARA THRU                        00912200
                            2300-WRITE-PARA-EXIT                        00912300
               WHEN INPUT-EOF                                           00913000
                    DISPLAY '|NOMORE RECORS        |'                   00914000
               WHEN OTHER                                               00915000
                    DISPLAY '|ERROR IN READ INPUT FILE |', WS-FS1       00916000
                    STOP RUN                                            00917000
           END-EVALUATE.                                                00918000
       2200-READ-PARA-EXIT. EXIT.                                       00920000
       2300-WRITE-PARA.                                                 00930000
                                                                        00940000
           MOVE SHARE-NO               TO SHARE-NO-KSDS                 00950000
           MOVE PER-HELD               TO PER-HELD-KSDS                 00960000
           MOVE NO-OF-SHARES           TO NO-OF-SHARES-KSDS             00970000
           MOVE CORP-NAME              TO CORP-NAME-KSDS                00980000
           MOVE CURR-PRICE             TO CURR-PRICE-KSDS               00990000
           WRITE KSDS-RECORD.                                           01000000
                                                                        01010000
       2300-WRITE-PARA-EXIT. EXIT.                                      01020000
                                                                        01030000
       3000-TERMINATE-PARA.                                             01040000
           CLOSE TI01-INPUT-FILE                                        01041000
           EVALUATE TRUE                                                01042000
               WHEN INPUT-IO-STATUS                                     01043000
                    DISPLAY '|INPUT FILE IS CLOSED |'                   01044000
               WHEN OTHER                                               01045000
                    DISPLAY '|ERROR IN CLOSE INPUT FILE |', WS-FS1      01046000
                    STOP RUN                                            01047000
           END-EVALUATE.                                                01048000
           CLOSE  MO01-KSDS-FILE                                        01049000
           EVALUATE TRUE                                                01049100
               WHEN KSDS-IO-STATUS                                      01049200
                    DISPLAY '|KSDS  FILE IS CLOSED |'                   01049300
               WHEN OTHER                                               01049400
                    DISPLAY '|ERROR IN CLOSE KSDS  FILE |', WS-FS2      01049500
                    STOP RUN                                            01049600
           END-EVALUATE.                                                01049700
       3000-TERMINATE-PARA-EXIT. EXIT.                                  01050000
           STOP RUN.                                                    01060000
